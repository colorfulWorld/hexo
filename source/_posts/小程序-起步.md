---
title: 小程序-起步
date: 2018-04-03 16:21:08
tags:
---
小程序学习笔记

<!--more-->

## 小程序的特点

小程序不可以使用现在已经存在的JavaScript组件库，因为它跟angular是一样用数据驱动的，所以是没有window对象的，不能操作DOM。

## 小程序文件类型与目录结构
- project.config.json：在工具上做的任何配置都会写入到这个文件。
- app.json：是对当前小程序的全局配置，包括了小程序的所有页面路径，界面表现，网络超时时间，底部tab等。
    - page：用于描述当前小程序所有页面路径，这是为了让微信客户端知道当前你的小程序页面定义在哪个目录。
    - window：小程序所有页面的顶部北京颜色，文字颜色定义在这里的。
- wxml：是用来编写小程序骨架的文件，`view`起到代码分割的作用。

## 移动端分辨率机小程序自适应单位RPX
- 不同的机型的分辨率是不同，所以RPX 能做到响应式更改比例。（相当于flexble.js）

### 移动设备的分辨率与rpx
- pt 物理逻辑单位，是指的是手机的长度的单位，和屏幕的大小尺寸友关系，简单理解为长度和视觉单位。
- px 物理分辨率，和屏幕尺寸没有关系，点没有大小。
- 1个pt可以有1个px构成，也可以有2个，还可以有3个。
- iphone6下2个px才构成一个pt。
- Ip6下 1px = 1rpx，Ip6 plus下1px = 0.6rpx。文字是不太适合用rpx 的。

## 数据绑定
```javascript
// wxml
<view>{{message}}</view>

//page.js
Page({
    data:{
        message:'Hello MINA'
    }
})

```

## 事件绑定和冒泡
- key 以bind或catch开头，然后跟上事件的类型，入bindtao、catchtouchstart。或者是bind:tap、catch:touchstart。
- value是一个字符串，需要在对应的Page中定义同名的函数。不然触发时间的时候回报错。

**bind事件绑定不会阻止冒泡事件向上冒泡。catch事件绑定可以阻止冒泡事件向上冒泡**

```html
<view id="outer" bindtap="handleTap1">
  outer view
  <view id="middle" catchtap="handleTap2">
    middle view
    <view id="inner" bindtap="handleTap3">
      inner view
    </view>
  </view>
</view>
```
如在上边这个例子中，点击 inner view 会先后调用handleTap3和handleTap2(因为tap事件会冒泡到 middle view，而 middle view 阻止了 tap 事件冒泡，不再向父节点传递)，点击 middle view 会触发handleTap2，点击 outer view 会触发handleTap1。

## 碎片知识点

- `wx.navigateTo` 带返回的跳转。小程序限制最多5级。
- `wx.redirectTo` 不带返回的跳转。
- `onUnload` 当使用 `wx.redirectTo` 时触发，表示被关闭和卸载。
- `onHide` 当页面使用`wx.navigateTo`时触发，表示页面被隐藏。
- `app()`函数用来注册小程序。接受一个object参数，其指定小程序的生命周期函数等。提供全局`getApp()`函数可以获取到小程序实例。`app()`必须早app.js中注册，  且不能注册多个！！

## 本地缓存
每个小程序都可以有自己的本地缓存，可以通过`wx.setStorage（wx.setStorageSync）、wx.getStorage（wx.getStorageSync）、wx.clearStorage（wx.clearStorageSync）`

此时有同步和异步的区别，二者的区别是异步不会阻塞当前任务，同步缓存会直到同步方法处理完后才能继续往下执行。但是异步可能会使得数据保存不成功。